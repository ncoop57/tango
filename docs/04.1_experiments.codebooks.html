---

title: Features

keywords: fastai
sidebar: home_sidebar

summary: "This module contains all the necessary functions for extracting and organizing features from videos."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04.1_experiments.codebooks.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/tf/data/datasets/videos&quot;</span><span class="p">)</span>
<span class="n">video_paths</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;**/video.mp4&quot;</span><span class="p">));</span> <span class="n">video_paths</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[PosixPath(&#39;/tf/data/datasets/videos/art_and_design/ibis_paint/scenario1/video.mp4&#39;),
 PosixPath(&#39;/tf/data/datasets/videos/art_and_design/ibis_paint/scenario2/video.mp4&#39;),
 PosixPath(&#39;/tf/data/datasets/videos/art_and_design/pixel_art_paint/scenario1/video.mp4&#39;),
 PosixPath(&#39;/tf/data/datasets/videos/art_and_design/pixel_art_paint/scenario2/video.mp4&#39;),
 PosixPath(&#39;/tf/data/datasets/videos/auto_and_vehicles/car_part/scenario1/video.mp4&#39;),
 PosixPath(&#39;/tf/data/datasets/videos/auto_and_vehicles/car_part/scenario2/video.mp4&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rico_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/tf/data/combined/data&#39;</span><span class="p">)</span>
<span class="n">img_paths</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rico_path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.jpg&#39;</span><span class="p">))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">img_paths</span><span class="p">),</span> <span class="n">img_paths</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(66261,
 [PosixPath(&#39;/tf/data/combined/data/0.jpg&#39;),
  PosixPath(&#39;/tf/data/combined/data/1.jpg&#39;),
  PosixPath(&#39;/tf/data/combined/data/10.jpg&#39;),
  PosixPath(&#39;/tf/data/combined/data/100.jpg&#39;),
  PosixPath(&#39;/tf/data/combined/data/1000.jpg&#39;)])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="k">import</span> <span class="n">sample</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># sampled_imgs = [np.array(Image.open(img)) for img in sample(img_paths, n)]</span>
<span class="n">sampled_imgs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">sample</span><span class="p">(</span><span class="n">img_paths</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">sampled_imgs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>100</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="SimCLR-Features">SimCLR Features<a class="anchor-link" href="#SimCLR-Features">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;SimCLR-ResNet50&#39;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SimCLRModel</span><span class="o">.</span><span class="n">load_from_checkpoint</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="o">=</span><span class="s1">&#39;/tf/data/models/simclr/checkpointepoch=98.ckpt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">simclr_extractor</span> <span class="o">=</span> <span class="n">SimCLRExtractor</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">run_experiment</span><span class="p">(</span><span class="n">imgs</span><span class="p">,</span> <span class="n">extractor</span><span class="p">,</span> <span class="n">vw</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vwords</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">codebook</span> <span class="o">=</span> <span class="n">gen_vcodebook</span><span class="p">(</span><span class="n">sampled_imgs</span><span class="p">,</span> <span class="n">simclr_extractor</span><span class="p">,</span> <span class="n">vwords</span><span class="p">)</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;/tf/data/models/cookbook_</span><span class="si">{model_name}</span><span class="s1">mdl_{len(sampled_imgs)}n_</span><span class="si">{vwords}</span><span class="s1">vw.model&#39;</span>
<span class="c1"># pickle.dump(codebook, open(fname, &#39;wb&#39;))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(100, 64)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">codebook</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([3, 3, 0, 5, ..., 2, 2, 2, 7], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">codebook</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1, 100)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">codebook</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">vwords</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># plt.bar(range(vwords), df)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-123-868b78e30439&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> df <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>histogram<span class="ansi-blue-fg">(</span>codebook<span class="ansi-blue-fg">.</span>labels_<span class="ansi-blue-fg">,</span> bins <span class="ansi-blue-fg">=</span> range<span class="ansi-blue-fg">(</span>vwords<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>plt<span class="ansi-blue-fg">.</span>bar<span class="ansi-blue-fg">(</span>range<span class="ansi-blue-fg">(</span>vwords<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> df<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/matplotlib/pyplot.py</span> in <span class="ansi-cyan-fg">bar</span><span class="ansi-blue-fg">(x, height, width, bottom, align, data, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2438</span>     return gca().bar(
<span class="ansi-green-intense-fg ansi-bold">   2439</span>         x<span class="ansi-blue-fg">,</span> height<span class="ansi-blue-fg">,</span> width<span class="ansi-blue-fg">=</span>width<span class="ansi-blue-fg">,</span> bottom<span class="ansi-blue-fg">=</span>bottom<span class="ansi-blue-fg">,</span> align<span class="ansi-blue-fg">=</span>align<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">-&gt; 2440</span><span class="ansi-red-fg">         **({&#34;data&#34;: data} if data is not None else {}), **kwargs)
</span><span class="ansi-green-intense-fg ansi-bold">   2441</span> 
<span class="ansi-green-intense-fg ansi-bold">   2442</span> 

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/matplotlib/__init__.py</span> in <span class="ansi-cyan-fg">inner</span><span class="ansi-blue-fg">(ax, data, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1599</span>     <span class="ansi-green-fg">def</span> inner<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> data<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1600</span>         <span class="ansi-green-fg">if</span> data <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1601</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>map<span class="ansi-blue-fg">(</span>sanitize_sequence<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1602</span> 
<span class="ansi-green-intense-fg ansi-bold">   1603</span>         bound <span class="ansi-blue-fg">=</span> new_sig<span class="ansi-blue-fg">.</span>bind<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/matplotlib/axes/_axes.py</span> in <span class="ansi-cyan-fg">bar</span><span class="ansi-blue-fg">(self, x, height, width, bottom, align, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2373</span>         x, height, width, y, linewidth = np.broadcast_arrays(
<span class="ansi-green-intense-fg ansi-bold">   2374</span>             <span class="ansi-red-fg"># Make args iterable too.</span>
<span class="ansi-green-fg">-&gt; 2375</span><span class="ansi-red-fg">             np.atleast_1d(x), height, width, y, linewidth)
</span><span class="ansi-green-intense-fg ansi-bold">   2376</span> 
<span class="ansi-green-intense-fg ansi-bold">   2377</span>         <span class="ansi-red-fg"># Now that units have been converted, set the tick locations.</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/numpy/lib/stride_tricks.py</span> in <span class="ansi-cyan-fg">broadcast_arrays</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    257</span>     args <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>_m<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> subok<span class="ansi-blue-fg">=</span>subok<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> _m <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    258</span> 
<span class="ansi-green-fg">--&gt; 259</span><span class="ansi-red-fg">     </span>shape <span class="ansi-blue-fg">=</span> _broadcast_shape<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    260</span> 
<span class="ansi-green-intense-fg ansi-bold">    261</span>     <span class="ansi-green-fg">if</span> all<span class="ansi-blue-fg">(</span>array<span class="ansi-blue-fg">.</span>shape <span class="ansi-blue-fg">==</span> shape <span class="ansi-green-fg">for</span> array <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/numpy/lib/stride_tricks.py</span> in <span class="ansi-cyan-fg">_broadcast_shape</span><span class="ansi-blue-fg">(*args)</span>
<span class="ansi-green-intense-fg ansi-bold">    191</span>     <span class="ansi-red-fg"># use the old-iterator because np.nditer does not handle size 0 arrays</span>
<span class="ansi-green-intense-fg ansi-bold">    192</span>     <span class="ansi-red-fg"># consistently</span>
<span class="ansi-green-fg">--&gt; 193</span><span class="ansi-red-fg">     </span>b <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>broadcast<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">32</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    194</span>     <span class="ansi-red-fg"># unfortunately, it cannot handle 32 or more arguments directly</span>
<span class="ansi-green-intense-fg ansi-bold">    195</span>     <span class="ansi-green-fg">for</span> pos <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">32</span><span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">31</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">ValueError</span>: shape mismatch: objects cannot be broadcast to a single shape</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vwords</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">codebook</span><span class="o">.</span><span class="n">labels_</span> <span class="o">==</span> <span class="n">i</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0 17
1 13
2 8
3 14
4 1
5 25
6 9
7 6
8 1
9 6
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">codebook</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">vwords</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">];</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([17, 13,  8, 14,  1, 25,  9,  6,  1,  6])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">codebook</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 0, 17],
       [ 1, 13],
       [ 2,  8],
       [ 3, 14],
       [ 4,  1],
       [ 5, 25],
       [ 6,  9],
       [ 7,  6],
       [ 8,  1],
       [ 9,  6]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([17, 13,  8, 14,  1, 25,  9,  6,  7])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vwords</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;constant&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([17, 13,  8, 14,  1, 25,  9,  6,  7,  0])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vwords</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">vwords</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0., 1., 0., 0., 0., 0., 1., 1., 2.]),
 array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]),
 &lt;a list of 9 Patch objects&gt;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vid = Video(video_paths[3])</span>
<span class="n">bovw</span> <span class="o">=</span> <span class="n">new_get_bovw</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">simclr_extractor</span><span class="p">,</span> <span class="n">codebook</span><span class="p">,</span> <span class="n">vwords</span><span class="p">,</span> <span class="n">frames_to_keep</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">vwords</span><span class="p">),</span> <span class="n">bovw</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;BarContainer object of 10 artists&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
</div>
 

